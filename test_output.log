============================= test session starts ==============================
platform darwin -- Python 3.11.11, pytest-7.4.4, pluggy-1.6.0
rootdir: /Users/johnreese/workspace/investos/investos
configfile: pyproject.toml
plugins: anyio-4.10.0
collected 1 item

tests/guide_examples/spo_tranches_distr_test.py Generating historical portfolio trades and positions at 2025-09-25 13:04:58...

Distributing trade generation with Dask client.

Trade-specific costs, constraints, and risk-models will continue to work as expected.

Creating Dask cluster at 2025-09-25 13:04:58...
Connection attempt 1 failed: Cluster failed to start: Timed out trying to connect to tcp://18.116.62.227:8786 after 30 s. Will retry in 15s

Creating Dask cluster at 2025-09-25 13:07:07...
Connection attempt 2 failed: Cluster failed to start: Timed out trying to connect to tcp://3.142.149.14:8786 after 30 s. Will retry in 15s

Creating Dask cluster at 2025-09-25 13:09:28...
Connection attempt 3 failed: Cluster failed to start: Timed out trying to connect to tcp://18.188.45.82:8786 after 30 s. Will retry in 15s

Creating Dask cluster at 2025-09-25 13:11:38...
Connection attempt 4 failed: Cluster failed to start: Timed out trying to connect to tcp://13.59.211.66:8786 after 30 s. Will retry in 15s

Creating Dask cluster at 2025-09-25 13:13:45...
Connection attempt 5 failed: Cluster failed to start: Timed out trying to connect to tcp://3.19.244.142:8786 after 30 s. Will retry in 15s
F

=================================== FAILURES ===================================
______________________________ test_spo_tranches _______________________________

fut = <coroutine object BaseTCPConnector.connect at 0x357214b80>
timeout = 1.8215858936309814

    async def wait_for(fut: Awaitable[T], timeout: float) -> T:
        async with asyncio.timeout(timeout):
>           return await fut

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py:1952: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/comm/tcp.py:546: in connect
    stream = await self.client.connect(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tornado.tcpclient.TCPClient object at 0x147c13ed0>
host = '3.19.244.142', port = 8786, af = <AddressFamily.AF_UNSPEC: 0>
ssl_options = None, max_buffer_size = 68719476736.0, source_ip = None
source_port = None, timeout = None

    async def connect(
        self,
        host: str,
        port: int,
        af: socket.AddressFamily = socket.AF_UNSPEC,
        ssl_options: Optional[Union[Dict[str, Any], ssl.SSLContext]] = None,
        max_buffer_size: Optional[int] = None,
        source_ip: Optional[str] = None,
        source_port: Optional[int] = None,
        timeout: Optional[Union[float, datetime.timedelta]] = None,
    ) -> IOStream:
        """Connect to the given host and port.
    
        Asynchronously returns an `.IOStream` (or `.SSLIOStream` if
        ``ssl_options`` is not None).
    
        Using the ``source_ip`` kwarg, one can specify the source
        IP address to use when establishing the connection.
        In case the user needs to resolve and
        use a specific interface, it has to be handled outside
        of Tornado as this depends very much on the platform.
    
        Raises `TimeoutError` if the input future does not complete before
        ``timeout``, which may be specified in any form allowed by
        `.IOLoop.add_timeout` (i.e. a `datetime.timedelta` or an absolute time
        relative to `.IOLoop.time`)
    
        Similarly, when the user requires a certain source port, it can
        be specified using the ``source_port`` arg.
    
        .. versionchanged:: 4.5
           Added the ``source_ip`` and ``source_port`` arguments.
    
        .. versionchanged:: 5.0
           Added the ``timeout`` argument.
        """
        if timeout is not None:
            if isinstance(timeout, numbers.Real):
                timeout = IOLoop.current().time() + timeout
            elif isinstance(timeout, datetime.timedelta):
                timeout = IOLoop.current().time() + timeout.total_seconds()
            else:
                raise TypeError("Unsupported timeout %r" % timeout)
        if timeout is not None:
            addrinfo = await gen.with_timeout(
                timeout, self.resolver.resolve(host, port, af)
            )
        else:
            addrinfo = await self.resolver.resolve(host, port, af)
        connector = _Connector(
            addrinfo,
            functools.partial(
                self._create_stream,
                max_buffer_size,
                source_ip=source_ip,
                source_port=source_port,
            ),
        )
>       af, addr, stream = await connector.start(connect_timeout=timeout)
E       asyncio.exceptions.CancelledError

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/tcpclient.py:279: CancelledError

The above exception was the direct cause of the following exception:

addr = 'tcp://3.19.244.142:8786', timeout = 30, deserialize = True
handshake_overrides = None
connection_args = {'extra_conn_args': {}, 'require_encryption': False, 'ssl_context': None}
scheme = 'tcp', loc = '3.19.244.142:8786'
backend = <distributed.comm.tcp.TCPBackend object at 0x1649edd10>
connector = <distributed.comm.tcp.TCPConnector object at 0x35798ebd0>
comm = None, time_left = <function connect.<locals>.time_left at 0x357af3ec0>
backoff_base = 0.01

    async def connect(
        addr, timeout=None, deserialize=True, handshake_overrides=None, **connection_args
    ):
        """
        Connect to the given address (a URI such as ``tcp://127.0.0.1:1234``)
        and yield a ``Comm`` object.  If the connection attempt fails, it is
        retried until the *timeout* is expired.
        """
        if timeout is None:
            timeout = dask.config.get("distributed.comm.timeouts.connect")
        timeout = parse_timedelta(timeout, default="seconds")
    
        scheme, loc = parse_address(addr)
        backend = registry.get_backend(scheme)
        connector = backend.get_connector()
        comm = None
    
        start = time()
    
        def time_left():
            deadline = start + timeout
            return max(0, deadline - time())
    
        backoff_base = 0.01
        attempt = 0
        logger.debug("Establishing connection to %s", loc)
        # Prefer multiple small attempts than one long attempt. This should protect
        # primarily from DNS race conditions
        # gh3104, gh4176, gh4167
        intermediate_cap = timeout / 5
        active_exception = None
        while time_left() > 0:
            try:
>               comm = await wait_for(
                    connector.connect(loc, deserialize=deserialize, **connection_args),
                    timeout=min(intermediate_cap, time_left()),
                )

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/comm/core.py:342: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py:1951: in wait_for
    async with asyncio.timeout(timeout):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Timeout [expired]>
exc_type = <class 'asyncio.exceptions.CancelledError'>
exc_val = CancelledError(), exc_tb = <traceback object at 0x357b67fc0>

    async def __aexit__(
        self,
        exc_type: Optional[Type[BaseException]],
        exc_val: Optional[BaseException],
        exc_tb: Optional[TracebackType],
    ) -> Optional[bool]:
        assert self._state in (_State.ENTERED, _State.EXPIRING)
    
        if self._timeout_handler is not None:
            self._timeout_handler.cancel()
            self._timeout_handler = None
    
        if self._state is _State.EXPIRING:
            self._state = _State.EXPIRED
    
            if self._task.uncancel() <= self._cancelling and exc_type is exceptions.CancelledError:
                # Since there are no new cancel requests, we're
                # handling this.
>               raise TimeoutError from exc_val
E               TimeoutError

/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/timeouts.py:115: TimeoutError

The above exception was the direct cause of the following exception:

self = FargateCluster(f41f21a2, 'tcp://3.19.244.142:8786', workers=0, threads=0, memory=0 B)

    async def _start(self):
        while self.status == Status.starting:
            await asyncio.sleep(0.01)
        if self.status == Status.running:
            return
        if self.status == Status.closed:
            raise ValueError("Cluster is closed")
    
        self._lock = asyncio.Lock()
        self.status = Status.starting
    
        if self.scheduler_spec is None:
            try:
                import distributed.dashboard  # noqa: F401
            except ImportError:
                pass
            else:
                options = {"dashboard": True}
            self.scheduler_spec = {"cls": Scheduler, "options": options}
    
        try:
            # Check if scheduler has already been created by a subclass
            if self.scheduler is None:
                cls = self.scheduler_spec["cls"]
                if isinstance(cls, str):
                    cls = import_term(cls)
                self.scheduler = cls(**self.scheduler_spec.get("options", {}))
                self.scheduler = await self.scheduler
            self.scheduler_comm = rpc(
                getattr(self.scheduler, "external_address", None)
                or self.scheduler.address,
                connection_args=self.security.get_connection_args("client"),
            )
>           await super()._start()

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/deploy/spec.py:331: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/deploy/cluster.py:133: in _start
    comm = await self.scheduler_comm.live_comm()
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/core.py:1130: in live_comm
    comm = await connect(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

addr = 'tcp://3.19.244.142:8786', timeout = 30, deserialize = True
handshake_overrides = None
connection_args = {'extra_conn_args': {}, 'require_encryption': False, 'ssl_context': None}
scheme = 'tcp', loc = '3.19.244.142:8786'
backend = <distributed.comm.tcp.TCPBackend object at 0x1649edd10>
connector = <distributed.comm.tcp.TCPConnector object at 0x35798ebd0>
comm = None, time_left = <function connect.<locals>.time_left at 0x357af3ec0>
backoff_base = 0.01

    async def connect(
        addr, timeout=None, deserialize=True, handshake_overrides=None, **connection_args
    ):
        """
        Connect to the given address (a URI such as ``tcp://127.0.0.1:1234``)
        and yield a ``Comm`` object.  If the connection attempt fails, it is
        retried until the *timeout* is expired.
        """
        if timeout is None:
            timeout = dask.config.get("distributed.comm.timeouts.connect")
        timeout = parse_timedelta(timeout, default="seconds")
    
        scheme, loc = parse_address(addr)
        backend = registry.get_backend(scheme)
        connector = backend.get_connector()
        comm = None
    
        start = time()
    
        def time_left():
            deadline = start + timeout
            return max(0, deadline - time())
    
        backoff_base = 0.01
        attempt = 0
        logger.debug("Establishing connection to %s", loc)
        # Prefer multiple small attempts than one long attempt. This should protect
        # primarily from DNS race conditions
        # gh3104, gh4176, gh4167
        intermediate_cap = timeout / 5
        active_exception = None
        while time_left() > 0:
            try:
                comm = await wait_for(
                    connector.connect(loc, deserialize=deserialize, **connection_args),
                    timeout=min(intermediate_cap, time_left()),
                )
                break
            except FatalCommClosedError:
                raise
            # Note: CommClosed inherits from OSError
            except (asyncio.TimeoutError, OSError) as exc:
                active_exception = exc
    
                # As described above, the intermediate timeout is used to distributed
                # initial, bulk connect attempts homogeneously. In particular with
                # the jitter upon retries we should not be worred about overloading
                # any more DNS servers
                intermediate_cap = timeout
                # FullJitter see https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/
    
                upper_cap = min(time_left(), backoff_base * (2**attempt))
                backoff = random.uniform(0, upper_cap)
                attempt += 1
                logger.debug(
                    "Could not connect to %s, waiting for %s before retrying", loc, backoff
                )
                await asyncio.sleep(backoff)
        else:
>           raise OSError(
                f"Timed out trying to connect to {addr} after {timeout} s"
            ) from active_exception
E           OSError: Timed out trying to connect to tcp://3.19.244.142:8786 after 30 s

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/comm/core.py:368: OSError

The above exception was the direct cause of the following exception:

    def test_spo_tranches():
        actual_returns = pd.read_parquet(
            "https://investos.io/example_actual_returns.parquet"
        )
        forecast_returns = pd.read_parquet(
            "https://investos.io/example_forecast_returns.parquet"
        )
    
        # For trading costs:
        actual_prices = pd.read_parquet(
            "https://investos.io/example_spo_actual_prices.parquet"
        )
        forecast_volume = pd.Series(
            pd.read_csv(
                "https://investos.io/example_spo_forecast_volume.csv", index_col="asset"
            ).squeeze(),
            name="forecast_volume",
        )
        forecast_std_dev = pd.Series(
            pd.read_csv(
                "https://investos.io/example_spo_forecast_std_dev.csv", index_col="asset"
            ).squeeze(),
            name="forecast_std_dev",
        )
        half_spread_percent = 2.5 / 10_000  # 2.5 bps
        half_spread = pd.Series(index=forecast_returns.columns, data=half_spread_percent)
    
        # For short holding costs:
        short_cost_percent = 40 / 10_000  # 40 bps
        trading_days_per_year = 252
        short_rates = pd.Series(
            index=forecast_returns.columns, data=short_cost_percent / trading_days_per_year
        )
    
        n_periods_held = 30
    
        strategy = inv.portfolio.strategy.SPOTranches(
            actual_returns=actual_returns,
            forecast_returns=forecast_returns,
            costs=[
                ShortHoldingCost(short_rates=short_rates, exclude_assets=["cash"]),
                TradingCost(
                    actual_prices=actual_prices,
                    forecast_volume=forecast_volume,
                    forecast_std_dev=forecast_std_dev,
                    half_spread=half_spread,
                    exclude_assets=["cash"],
                ),
            ],
            constraints=[
                MaxLongTradeLeverageConstraint(limit=1.3 / n_periods_held),
                MaxShortTradeLeverageConstraint(limit=0.3 / n_periods_held),
                MinTradeWeightConstraint(limit=-0.03 / n_periods_held),
                MaxTradeWeightConstraint(limit=0.03 / n_periods_held),
                LongCashConstraint(),
            ],
            n_periods_held=n_periods_held,
            cash_column_name="cash",
            solver_opts={
                "eps_abs": 1e-5,
                "eps_rel": 1e-5,
                "adaptive_rho_interval": 50,
            },
        )
    
        portfolio = inv.portfolio.BacktestController(
            strategy=strategy,
            distributed=True,
            dask_cluster_config = {
                "n_workers": 10,
                "environment": {
                    "EXTRA_PIP_PACKAGES": "investos scikit-learn numpy>=2.0",
                },
            },
            start_date="2017-01-01",
            end_date="2017-06-30",
            hooks={
                "after_trades": [
                    lambda backtest, t, u, h_next: print(".", end=""),
                ]
            },
        )
    
>       backtest_result = portfolio.generate_positions()

tests/guide_examples/spo_tranches_distr_test.py:100: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
investos/portfolio/backtest_controller.py:64: in generate_positions
    self._dask_start_client_and_cluster()
investos/portfolio/backtest_controller.py:125: in _dask_start_client_and_cluster
    self.dask_cluster = FargateCluster(**self.dask_cluster_config)
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py:1489: in __init__
    super().__init__(fargate_scheduler=True, fargate_workers=True, **kwargs)
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py:800: in __init__
    super().__init__(**kwargs)
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/deploy/spec.py:284: in __init__
    self.sync(self._start)
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py:363: in sync
    return sync(
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py:439: in sync
    raise error
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py:413: in f
    result = yield future
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py:783: in run
    value = future.result()
../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py:999: in _start
    await super()._start()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = FargateCluster(f41f21a2, 'tcp://3.19.244.142:8786', workers=0, threads=0, memory=0 B)

    async def _start(self):
        while self.status == Status.starting:
            await asyncio.sleep(0.01)
        if self.status == Status.running:
            return
        if self.status == Status.closed:
            raise ValueError("Cluster is closed")
    
        self._lock = asyncio.Lock()
        self.status = Status.starting
    
        if self.scheduler_spec is None:
            try:
                import distributed.dashboard  # noqa: F401
            except ImportError:
                pass
            else:
                options = {"dashboard": True}
            self.scheduler_spec = {"cls": Scheduler, "options": options}
    
        try:
            # Check if scheduler has already been created by a subclass
            if self.scheduler is None:
                cls = self.scheduler_spec["cls"]
                if isinstance(cls, str):
                    cls = import_term(cls)
                self.scheduler = cls(**self.scheduler_spec.get("options", {}))
                self.scheduler = await self.scheduler
            self.scheduler_comm = rpc(
                getattr(self.scheduler, "external_address", None)
                or self.scheduler.address,
                connection_args=self.security.get_connection_args("client"),
            )
            await super()._start()
        except Exception as e:  # pragma: no cover
            self.status = Status.failed
            await self._close()
>           raise RuntimeError(f"Cluster failed to start: {e}") from e
E           RuntimeError: Cluster failed to start: Timed out trying to connect to tcp://3.19.244.142:8786 after 30 s

../../../Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/deploy/spec.py:335: RuntimeError
=========================== short test summary info ============================
FAILED tests/guide_examples/spo_tranches_distr_test.py::test_spo_tranches - R...
======================== 1 failed in 649.89s (0:10:49) =========================
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1298, in _delete_worker_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1224, in _delete_scheduler_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1032, in _delete_cluster
    async for page in ecs.get_paginator("list_tasks").paginate(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 39, in __anext__
    response = await self._make_request(current_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 19, in _make_request
    return await self._method(**current_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1298, in _delete_worker_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1224, in _delete_scheduler_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1032, in _delete_cluster
    async for page in ecs.get_paginator("list_tasks").paginate(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 39, in __anext__
    response = await self._make_request(current_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 19, in _make_request
    return await self._method(**current_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1298, in _delete_worker_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1224, in _delete_scheduler_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1032, in _delete_cluster
    async for page in ecs.get_paginator("list_tasks").paginate(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 39, in __anext__
    response = await self._make_request(current_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 19, in _make_request
    return await self._method(**current_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1298, in _delete_worker_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1224, in _delete_scheduler_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1032, in _delete_cluster
    async for page in ecs.get_paginator("list_tasks").paginate(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 39, in __anext__
    response = await self._make_request(current_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 19, in _make_request
    return await self._method(**current_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1298, in _delete_worker_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1224, in _delete_scheduler_task_definition_arn
    await ecs.deregister_task_definition(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1113, in _delete_role
    attached_policies = (await iam.list_attached_role_policies(RoleName=role))[
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
Traceback (most recent call last):
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 223, in send
    response = await session.request(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/client.py", line 725, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1532, in _create_direct_connection
    hosts = await self._resolve_host(host, port, traces=traces)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1148, in _resolve_host
    return await asyncio.shield(resolved_host_task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/connector.py", line 1179, in _resolve_host_with_throttle
    addrs = await self._resolver.resolve(host, port, family=self._family)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiohttp/resolver.py", line 40, in resolve
    infos = await self._loop.getaddrinfo(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 868, in getaddrinfo
    return await self.run_in_executor(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 830, in run_in_executor
    executor.submit(func, *args), loop=self)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 666, in _exitfunc
    f()
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/weakref.py", line 590, in __call__
    return info.func(*info.args, **(info.kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 363, in sync
    return sync(
           ^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 439, in sync
    raise error
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/distributed/utils.py", line 413, in f
    result = yield future
             ^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/tornado/gen.py", line 783, in run
    value = future.result()
            ^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/dask_cloudprovider/aws/ecs.py", line 1032, in _delete_cluster
    async for page in ecs.get_paginator("list_tasks").paginate(
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 39, in __anext__
    response = await self._make_request(current_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/paginate.py", line 19, in _make_request
    return await self._method(**current_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/context.py", line 36, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 406, in _make_api_call
    http, parsed_response = await self._make_request(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/client.py", line 432, in _make_request
    return await self._endpoint.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 120, in _send_request
    while await self._needs_retry(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 280, in _needs_retry
    responses = await self._event_emitter.emit(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/hooks.py", line 68, in _emit
    response = await resolve_awaitable(handler(**kwargs))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 107, in _call
    if await resolve_awaitable(self._checker(**checker_kwargs)):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 126, in _call
    should_retry = await self._should_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 152, in _should_retry
    return await resolve_awaitable(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/_helpers.py", line 6, in resolve_awaitable
    return await obj
           ^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/retryhandler.py", line 174, in _call
    checker(attempt_number, response, caught_exception)
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 247, in __call__
    return self._check_caught_exception(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/botocore/retryhandler.py", line 416, in _check_caught_exception
    raise caught_exception
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 201, in _do_get_response
    http_response = await self._send(request)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/endpoint.py", line 303, in _send
    return await self.http_session.send(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnreese/Library/Caches/pypoetry/virtualenvs/investos-copHm8uW-py3.11/lib/python3.11/site-packages/aiobotocore/httpsession.py", line 283, in send
    raise HTTPClientError(error=e)
botocore.exceptions.HTTPClientError: An HTTP Client raised an unhandled exception: cannot schedule new futures after shutdown
